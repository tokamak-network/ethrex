# Guest Program Overrides
#
# Usage:
#   ETHREX_GUEST_PROGRAM_ID=zk-dex \
#   DOCKER_ETHREX_WORKDIR=/usr/local/bin \
#   docker compose -f docker-compose.yaml -f docker-compose-guest-program.overrides.yaml up --detach --build
#
# Or use the Makefile:
#   make init-guest-program PROGRAM=zk-dex

services:
  ethrex_l2:
    environment:
      - ETHREX_GUEST_PROGRAM_ID=${ETHREX_GUEST_PROGRAM_ID:-evm-l2}
    volumes:
      - ./programs.toml:/etc/ethrex/programs.toml

  ethrex_prover:
    environment:
      - ETHREX_PROGRAMS_CONFIG=/etc/ethrex/programs.toml
    volumes:
      - ./programs.toml:/etc/ethrex/programs.toml
    command: >
      l2 prover
      --backend exec
      --proof-coordinators tcp://ethrex_l2:3900
      --programs-config /etc/ethrex/programs.toml
